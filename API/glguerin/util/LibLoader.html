<!-- Automatically generated with polardoc Version 1.0.7 on Sun Aug 10 12:16:12 MST 2003 --><!-- glguerin.util.LibLoader | Do not remove or edit this line! --><HTML><HEAD><TITLE>  Class glguerin.util.LibLoader</TITLE></HEAD><BODY BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#0000FF" ALINK="#0000FF"><A NAME="_top_"></A><PRE><A HREF="../../packages.html">All Packages</A>  <A HREF="../../Package-glguerin/util.html">This Package</A>  <A HREF="../../tree.html">Class Hierarchy</A>  <A HREF="../../Search.html">Class Search</A>  <A HREF="../../AllNames.html">Index</A></PRE><HR SIZE=1 ALIGN=left WIDTH="98%"><B><FONT FACE="Arial,Helvetica" SIZE=+2>     Class glguerin.util.LibLoader</FONT></B><PRE>java.lang.Object   |   +----glguerin.util.LibLoader</PRE><P><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Summary</B></FONT></TD> </TR> </TABLE><A NAME="_Summary_"></A><PRE>public class  <STRONG>LibLoader</STRONG>     extends java.lang.Object{          // Fields 2     protected final File <A HREF="#dirFallback">dirFallback</A>;     public static boolean <A HREF="#isVerbose">isVerbose</A>;          // Constructors 1     public <A HREF="#LibLoader()">LibLoader</A>();          // Methods 7     public static synchronized LibLoader <A HREF="#getLoader()">getLoader</A>();     public static LibLoader <A HREF="#makeLoader()">makeLoader</A>();     protected void <A HREF="#blab()">blab</A>();     protected void <A HREF="#load(java.lang.String, java.io.File)">load</A>(String, File);     public void <A HREF="#loadLibrary(java.lang.String)">loadLibrary</A>(String);     protected File <A HREF="#makeFallbackDir()">makeFallbackDir</A>();     public String <A HREF="#toString()">toString</A>();}</PRE><P><DL><P>A LibLoader encapsulates different ways to call System.load() or loadLibrary(), using one or more fallback locations as places to look for JNI libraries. This implementation is specifically designed for use with Cocoa-Java, which won't normally search for JNI libs in the Contents/Resources/Java section of an app-bundle.<p> Although designed for Cocoa-Java, it will work in any situation, since it relies first on System.loadLibrary(), and only after that fails does it resort to any fallback strategies. Also, this class will work on non-Mac platforms, because it always uses reflection to refer to any Mac-specific classes and methods. This makes the code more difficult to understand, but is much safer. Reflection is only used in LibLoader's constructor.  Thereafter, a File is used, so there is no ongoing performance cost for the fact that reflection is used.<p><b>USAGE</b><p> In general, call the static method getLoader() or makeLoader(), rather than instantiating a new LibLoader directly. Calling getLoader() will instantiate a LibLoader as needed, managing a private singleton thread-safely. Calling makeLoader() always makes a new LibLoader. In either case, the class instantiated may be controlled with the "glguerin.util.LibLoader.imp" property, which should be a fully qualified class name of a concrete LibLoader implementation.  Normally, you won't have to set the property.<p> The principal method in LibLoader is loadLibrary(). It calls System.loadLibrary() first, then its own fallback load() method if that fails. Only when System.loadLibrary() fails do any fallback strategies come into play. If there are no fallbacks in place, or none are necessary, then LibLoader.loadLibrary() is equivalent to System.loadLibrary(). If the fallback strategy fails, an UnsatisfiedLinkError is thrown, just as System.loadLibrary() does.<p> This typical invocation:<br>&nbsp;&nbsp;&nbsp;    LibLoader.getLoader().loadLibrary( "SomeLib" );<br>corresponds to:<br>&nbsp;&nbsp;&nbsp;    System.loadLibrary( "SomeLib" );<p> Properties used:  <br><b>glguerin.util.LibLoader.imp</b> --    The fully qualified class name of a LibLoader implementation used by makeLoader(),    which is also called by getLoader().  <br><b>glguerin.util.LibLoader.debug</b> --    A boolean ("true" or "false") controls whether diagnostics are printed to System.err    by load() and makeFallbackDir().  Default is false.<P></DL><P><BR><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Cross Reference</B></FONT></TD> </TR> </TABLE><BR><DL><DT><B>Returned By: </B><DD>LibLoader.<A HREF="../../glguerin/util/LibLoader.html#getLoader()">getLoader()</A>, LibLoader.<A HREF="../../glguerin/util/LibLoader.html#makeLoader()">makeLoader()</A><P></DL><BR><BR><BR><BR><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Fields</B></FONT></TD> </TR> </TABLE><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3> <A NAME="isVerbose"><FONT COLOR="#0000FF">&middot;</FONT> isVerbose</A></H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public static boolean isVerbose</PRE><BLOCKQUOTE><P>Set this flag to T for all LibLoader's to be verbose on System.err stream. The flag is initialized from the property "glguerin.util.LibLoader.debug", but can be changed programmatically, as well.<P><P> </BLOCKQUOTE><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3> <A NAME="dirFallback"><FONT COLOR="#FF00FF">&middot;</FONT> dirFallback</A></H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   protected final File dirFallback</PRE><BLOCKQUOTE><P>Passed to load(String,File) as location to look in for fallback strategy. This will be null if makeFallbackDir() returns null.<P><P> </BLOCKQUOTE><P><BR><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Constructors</B></FONT></TD> </TR> </TABLE><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="LibLoader"><FONT COLOR="#FFCC00">&middot;</FONT></A><A NAME="LibLoader()">LibLoader</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public LibLoader() </PRE><BLOCKQUOTE><DL><P>A default LibLoader has a fallback strategy appropriate for Cocoa-Java on Mac OS X.<P></DL></BLOCKQUOTE> <BR><BR><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Methods</B></FONT></TD> </TR> </TABLE><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="getLoader"><FONT COLOR="#00DD00">&middot;</FONT></A><A NAME="getLoader()">getLoader</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public static synchronized <A HREF="../../glguerin/util/LibLoader.html">LibLoader</A> getLoader() </PRE><BLOCKQUOTE><DL><P>Get a LibLoader appropriate to the configuration. It will reuse a known singleton, or make one if no singleton is known.<P></DL></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="makeLoader"><FONT COLOR="#00DD00">&middot;</FONT></A><A NAME="makeLoader()">makeLoader</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public static <A HREF="../../glguerin/util/LibLoader.html">LibLoader</A> makeLoader() </PRE><BLOCKQUOTE><DL><P>Make a LibLoader appropriate to the configuration. Not synchronized because it doesn't refer to any static variables.<P></DL></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="blab"><FONT COLOR="#FF0000">&middot;</FONT></A><A NAME="blab()">blab</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   protected void blab() </PRE><BLOCKQUOTE><DL><P>Called from constructor, an overridable diagnostic emitting dirFallback.<P></DL></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="loadLibrary"><FONT COLOR="#FF0000">&middot;</FONT></A><A NAME="loadLibrary(java.lang.String)">loadLibrary</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public void loadLibrary(String libName) </PRE><BLOCKQUOTE><DL><P>Load the library, using normal and fallback strategies. May be overridden in subclasses. The fallback strategies may be altered by overriding load(). The load() method should return normally on success, or throw an UnsatisfiedLinkError on failure.<P></DL><P> <B>See Also:</B><A HREF="#load">load</A></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="load"><FONT COLOR="#FF0000">&middot;</FONT></A><A NAME="load(java.lang.String, java.io.File)">load</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   protected void load(String libName,                       File location) </PRE><BLOCKQUOTE><DL><P>Try to load a JNI library from a fallback location represented as a directory File. Return normally on success, or throw an UnsatisfiedLinkError on failure. May be overridden in subclasses.<p> The File may be null, which this method may elect to handle or throw an UnsatisfiedLinkError. This imp throws an UnsatisfiedLinkError when File is null.<p> This imp takes a File designating a directory location, and hand-makes a path-name that follows the Mac OS X convention for JNI library names:  "Foo" loads "libFoo.dylib". It then calls System.load() to load the resulting absolute pathname. For other platforms or situations, override this method and assemble a library-name under your target platform's conventions. On purely Java 2 platforms, you can use System.mapLibraryName(). This implementation can't do that because it is 1.1-compatible.<P><DT> <B>Throws:</B> UnsatisfiedLinkError<DD> thrown when the named library could not be loaded.  Any overriding implementation of this method must throw this error on failure.</DL></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="makeFallbackDir"><FONT COLOR="#FF0000">&middot;</FONT></A><A NAME="makeFallbackDir()">makeFallbackDir</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   protected File makeFallbackDir() </PRE><BLOCKQUOTE><DL><P>Create a File representing a directory from which load(String,File) will load JNI libs. May return null if there is no fallback directory in which to look for JNI libs. Called from constructor to get a File, assigning it to dirFallback.<p> This imp uses reflection to attempt to load a Cocoa NSBundle class. On success, it returns a File referring to the "Java" sub-dir of the bundle's resources dir. On failure, it returns null so load(String,File) will fail.<P></DL></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="toString"><FONT COLOR="#FF0000">&middot;</FONT></A><A NAME="toString()">toString</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public String toString() </PRE><BLOCKQUOTE><DL><P>Return a String telling something about how libs are loaded.<P><DT><B>Overrides:</B><DD>toString in class Object</DL></BLOCKQUOTE> <BR><HR SIZE=1 ALIGN=left WIDTH="98%"><PRE><A HREF="../../packages.html">All Packages</A>  <A HREF="../../Package-glguerin/util.html">This Package</A>  <A HREF="../../tree.html">Class Hierarchy</A>  <A HREF="../../Search.html">Class Search</A>  <A HREF="../../AllNames.html">Index</A></PRE><FONT FACE="Arial,Helvetica" SIZE=-2>Freshly brewed Java API Documentation automatically generated with <A HREF="http://www.ualberta.ca/~tgee/polardoc">polardoc</A> Version 1.0.7<BR></FONT></BODY></HTML>