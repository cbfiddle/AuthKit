<!-- Automatically generated with polardoc Version 1.0.7 on Sun Aug 10 12:16:12 MST 2003 --><!-- app.authkit.test.TestAuth | Do not remove or edit this line! --><HTML><HEAD><TITLE>  Class app.authkit.test.TestAuth</TITLE></HEAD><BODY BGCOLOR="#FFFFFF" LINK="#0000FF" VLINK="#0000FF" ALINK="#0000FF"><A NAME="_top_"></A><PRE><A HREF="../../../packages.html">All Packages</A>  <A HREF="../../../Package-app/authkit/test.html">This Package</A>  <A HREF="../../../tree.html">Class Hierarchy</A>  <A HREF="../../../Search.html">Class Search</A>  <A HREF="../../../AllNames.html">Index</A></PRE><HR SIZE=1 ALIGN=left WIDTH="98%"><B><FONT FACE="Arial,Helvetica" SIZE=+2>     Class app.authkit.test.TestAuth</FONT></B><PRE>java.lang.Object   |   +----<A HREF="../../../app/authkit/test/AuthTest.html">app.authkit.test.AuthTest</A>           |           +----app.authkit.test.TestAuth</PRE><P><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Summary</B></FONT></TD> </TR> </TABLE><A NAME="_Summary_"></A><PRE>public class  <STRONG>TestAuth</STRONG>     extends app.authkit.test.<A HREF="../../../app/authkit/test/AuthTest.html">AuthTest</A>{          // Constructors 1     public <A HREF="#TestAuth()">TestAuth</A>();          // Methods 2     public static void <A HREF="#main(java.lang.String[])">main</A>(String[]);     public void <A HREF="#testAuth(glguerin.authkit.Authorization, java.lang.String, java.lang.String[])">testAuth</A>(Authorization, String, String[]);}</PRE><P><DL><P>TestAuth is the Swiss Army Knife test for Authorization methods. It can call every method of Authorization in one way or another. It does this by acting as a simple command interpreter over its command-line args. Some of its commands are "builtins" that call the Authorization methods. Everything else is an external command, which is run with elevated privileges using the execPrivileged() method.<p> The command-line args form an interpretable sequence of strings consisting of:<ol type="1">  <li>builtin commands, with args</li>  <li>external commands, with args</li>  <li>separators between groupings of command+args</li></ol><p> The command parser is very simple, and works with the individual Strings of the String[] received by main().  Those Strings are not subdivided or otherwise parsed or manipulated. The interpreter simply breaks the sequence into groups, examines the first String of the group, and acts accordingly. For example, the grouping separator is ":", but it's only recognized in isolation. The interpreter will not recognize embedded :'s, nor will it subdivide commands or args at :'s.<p> A command grouping is separated from a subsequent grouping by a single isolated ":".  Within a grouping, the first String is the command, and all other Strings are args for that command.  A grouping may be empty, which is quietly ignored.<p> Builtins were named to minimize collisions with external commands on Mac OS X. The builtin commands and their args are:<dl>  <dt><b><tt>see [privilege-name ...]</tt></b>  </dt><dd>  Display the current availability of each privilege-name, by calling isAvailable().  If no privilege-names are given, then list identity, latest date granted, and  current availability of the getPastGrantedPrivileges() enumeration.  </dd>  <dt><b><tt>pre privilege-name [...]</tt></b>  </dt><dd>  Call preauthorize() for the named privilege(s).  Interaction is always allowed.  To preauthorize the root-execution privilege, use a name of "system.privilege.admin" on Mac OS X.  </dd>  <dt><b><tt>au+ privilege-name [...]</tt></b>  </dt><dd>  Call authorize() for the named privilege(s), with interaction allowed.  </dd>  <dt><b><tt>au- privilege-name [...]</tt></b>  </dt><dd>  Call authorize() for the named privilege(s), with interaction disallowed.  </dd>  <dt><b><tt>put [pathname ...]</tt></b>  </dt><dd>  Write the secret identifier in binary to each given pathname, overwriting any file of that name.  If no pathnames are given, the secret identifier is dumped to stdout in hex.  <br><b>THIS APPROACH IS INSECURE, AND IS ONLY SUITABLE FOR TESTING.</b>  </dd>  <dt><b><tt>get [pathname]</tt></b>  </dt><dd>  If pathname is ".", call attachPrivileged() on a new Authorization, using it if successful.  If pathname is anything other than ".", read the secret identifier from the file,  call attach() on a new Authorization, and use it if successful.  The secret identifier in a file must refer to a still-active session, or it will fail.  The "." notation will only work if TestAuth is running in a JVM that was executed  as a child of execPrivileged().  Also see the TestAttach class.  </dd>  <dt><b><tt>#</tt></b>  </dt><dd>  Call release() on the current Authorization.  </dd>  <dt><b><tt>##</tt></b>  </dt><dd>  Call detach( true ) on the current Authorization.  </dd>  <dt><b><tt>ver</tt></b>  </dt><dd>  Print the values of the "java.version" and "java.home" system properties, as a diagnostic aid..  This calls no Authorization method.  </dd>  <dt><b><tt>zzz [seconds]</tt></b>  </dt><dd>  Sleep for the given integer number of seconds, or for 3 secs if no value given.  This calls no Authorization method.  It only uses Java code, and does not execute an external command.  </dd></dl><p> Any command not recognized as a builtin is interpreted as an external command, and will be executed using execPrivileged().  Some pre-processing may occur first:<dl>  <dt><b><tt>JAVA ...</tt></b>  </dt><dd>  The all-upper-case "JAVA" command is a quasi-builtin, a little like a shell command-alias.  It eventually executes an external command, but some substitution happens first.  It takes the "java.home" property, appends "/bin/java" to it, and then  executes that as an external command using execPrivileged().  <p>  The reason for doing this is that "java.home" will reflect the JVM currently running,  which may be 1.3.1 or 1.4.1 on Mac OS X, and execute that same JVM in another process.  If you just entered the command "/usr/bin/java", it won't necessarily be the current JVM.  <p>  You can customize which command in "java.home" is executed by defining it as a relative pathname  in the "auth.bin.java" property.  Be sure to use a file-separator appropriate to your platform.  The value should always be a partial pathname relative to the location given by "java.home".  </dd>  <dt><b><tt>@ <i>command</i> [...]</tt></b>  </dt><dd>  When "@" appears as a separated token before an external command,  then that command will have the secret identifier piped to it on its stdin stream.  The "@" must be separated from the following command by white-space.  Any external command can be run, including the <b>JAVA</b> quasi-builtin.  Only commands that read their standard input  will be useful.  For example, the 'echo' command will be useless at reading the secret.  </dd></dl><p> All external commands are executed using execPrivileged(), so they all run with elevated privileges. This is unwise as a general approach, but is acceptable for a test.<p> If authorization is needed before running an external command, it is obtained interactively if necessary. Failure to authorize or authenticate will fail to run the external command.<p> On Mac OS X, all commands executed by execPrivileged() must be absolute pathnames. If you don't know the absolute pathname of a command, use the 'which' command in your shell to tell you the pathname of a particular command.  For example, 'which java' or 'which id'.<p> The external command's stdout is piped to the System.out stream, and the bytes are counted and CRC'ed for comparison purposes. On Mac OS X, the stderr is simply shared with the privileged process.<p> If the Authorization's privileged Process implements waitFor(), the external command is waited for. Otherwise a 3-second delay occurs, then the interpreter resumes parsing and executing commands. Since MacOSXAuthorization's privileged Process doesn't provide waitFor(), long-running external commands may need a subsequent 'zzz' builtin command.<p> Before each command is executed, whether builtin or external, the Authorization's current public identifier is displayed on stdout.  This is done to help track when sessions are created, attached, and detached. It's also useful to compare to public identifiers displayed by other processes that attach to the same session.  The identifiers should be identical, even though from different processes.<p> Several system properties affect the TestAuth command interpreter: <dl> <dt><b><tt>"authkit.imp"</tt></b> </dt><dd> This property's value is the fully qualified class name of an Authorization to instantiate and use. See method main(). </dd>  <dt><b><tt>"between"</tt></b> </dt><dd> This optional property defines an override for the ":" string separating command groupings. The main use for this property is so you can execute a privileged version of this class in another process, and change the separator.  If you couldn't change the separator, you couldn't distinguish its commands from those of its parent.  That's because the TestAuth interpreter doesn't do escaping. Usually, you don't have to set "between" or change it in any way. </dd>  <dt><b><tt>"auth.bin.java"</tt></b> </dt><dd> This optional property defines an override for the "bin/java" command assembled by the quasi-builtin <b>JAVA</b> command. The main use for this property is when the external command isn't "bin/java", such as on Windows. Usually, you don't have to set "auth.bin.java" or change it in any way. See method doExec(). </dd>  </dl><P></DL><P><BR><BR><BR><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Constructors</B></FONT></TD> </TR> </TABLE><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="TestAuth"><FONT COLOR="#FFCC00">&middot;</FONT></A><A NAME="TestAuth()">TestAuth</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public TestAuth() </PRE><BLOCKQUOTE><DL><P>Create with default separator defined by "between" property, or ":".<P></DL></BLOCKQUOTE> <BR><BR><TABLE BGCOLOR="#00ccff" WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD><FONT FACE="arial,helvetica" SIZE=+1><B>&nbsp;&nbsp;Methods</B></FONT></TD> </TR> </TABLE><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="main"><FONT COLOR="#00DD00">&middot;</FONT></A><A NAME="main(java.lang.String[])">main</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public static void main(String[] args) </PRE><BLOCKQUOTE><DL><P>Static entry point, when used as an application.<P></DL></BLOCKQUOTE> <BR><TABLE WIDTH=100% CELLSPACING=0 CELLPADDING=1 BORDER=0> <TR> <TD WIDTH=80%><BR><H3><A NAME="testAuth"><FONT COLOR="#FF0000">&middot;</FONT></A><A NAME="testAuth(glguerin.authkit.Authorization, java.lang.String, java.lang.String[])">testAuth</A> </H3></TD> <TD ALIGN=right WIDTH=20%> <FONT SIZE="-2"><A HREF="#_Summary_">Summary</A> &nbsp;|&nbsp; <A HREF=#_top_>Top</A></FONT> </TD> </TR> </TABLE><PRE>   public void testAuth(<A HREF="../../../glguerin/authkit/Authorization.html">Authorization</A> auth,                         String dontCare,                         String[] args) </PRE><BLOCKQUOTE><DL><P>Do the test over all the args. In this test, the args represent a series of command+parameters groupings. As a result, we DO NOT want to iterate using AuthTest.testAuth(), hence this override.<p> The groupings contain both external commands, which must have absolute pathnames, and builtin commands, which are performed by methods of this class. All external commands are executed using Authorization.execPrivileged().<P><DT><B>Overrides:</B><DD><A HREF="../../../app/authkit/test/AuthTest.html#testAuth(glguerin.authkit.Authorization, java.lang.String, java.lang.String[])">testAuth</A> in class <A HREF="../../../app/authkit/test/AuthTest.html">AuthTest</A></DL></BLOCKQUOTE> <BR><HR SIZE=1 ALIGN=left WIDTH="98%"><PRE><A HREF="../../../packages.html">All Packages</A>  <A HREF="../../../Package-app/authkit/test.html">This Package</A>  <A HREF="../../../tree.html">Class Hierarchy</A>  <A HREF="../../../Search.html">Class Search</A>  <A HREF="../../../AllNames.html">Index</A></PRE><FONT FACE="Arial,Helvetica" SIZE=-2>Freshly brewed Java API Documentation automatically generated with <A HREF="http://www.ualberta.ca/~tgee/polardoc">polardoc</A> Version 1.0.7<BR></FONT></BODY></HTML>